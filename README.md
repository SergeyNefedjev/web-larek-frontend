# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src\common.blocks — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура проектной работы 

Архитектура приложения соответствует паттерну MVP, где каждый слой имеет свою чёткую задачу: слой данных отвечает за хранение и обработку информации, слой представления отвечает за пользовательский интерфейс, а презентер выступает посредником между ними, обеспечивая обновление представления на основе изменений в данных.

### Базовый код 

#### Класс Api 
Класс Api предназначен для реализации HTTP запросов к серверу.

Свойства:
- baseUrl — базовый URL для всех запросов.
- options — параметры запроса.

Методы: 
- `get` - отправляет GET-запрос по указанному адресу (эндпоинту) и возвращает результат, полученный от сервера, в виде Promise.
- `post` - метод для выполнения POST запроса.

#### Класс EventEmitter
 Брокер событий позволяет компонентам системы отправлять и получать уведомления о происходящих событиях. Презентеры используют этот класс для реагирования на события, а слои приложения — для их генерации.

 Основные методы, реализуемые классом, описаны интерфейсом `IEvents`
 - `on` - подписка на событие
 - `emit` - инициализация события
 - `trigger` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие.

 ### Слой данных

 ####  Класс ProductsInfo

Класс отвечает за управление информацией о товаре, отображаемой на странице. Он получает экземпляр брокера событий в конструкторе для обмена информацией с другими компонентами.
В полях класса хранятся следующие данные:

- _items - массив карточек с товаром 
- _preview - ID товара для показа в модальном окне.
- events - экземпляр класса EventEmitter для инициации событий при изменении данных.

Так же класс предоставляет набор методов для взаимодействия с этими данными.

- getProduct - по id возвращает карточку товара

- getProducts -  возвращает массив товаров 

а также имеет геттеры и сеттеры

### Класс BasketInfo

Класс, управляющий корзиной товаров и взаимодействующий с другими компонентами через брокер событий.
В полях класа храняться следующие данные: 

- _items - каталог товаров
-  events - экземпляр класса EventEmitter для инициации событий при изменении данных.

Так же класс предоставляет набор методов для взаимодействия с этими данными.

- addProduct - добавление товара
- deleteProduct - удаление товара 
- getProduct - получение карточки товара по id
- getTotalPrice - получение общей стоимости
- clear - очистка корзины

### Класс AppState

Класс, управляющий данными, необходимыми для оформления заказа: контактной информацией, адресом доставки и способом оплаты. Также включает в себя логику для проверки корректности введенных данных.
В полях класа храняться следующие данные:

- order - информация о заказе
- formErrors - объект, содержащий ошибки валидации полей формы оформления заказа. Ключами объекта являются имена полей, а значениями - сообщения об ошибках для этих полей.

Так же класс предоставляет набор методов для взаимодействия с этими данными.

- clearOrder -  сбрасывает данные, введенные пользователем в процессе оформления заказа
- setOrderField - Изменяет значение поля в объекте order, связанного с оплатой или адресом.
- setContactsField - Изменяет значение поля в объекте order, связанного с контактной информацией.
- validateOrder - Выполняет валидацию данных об оплате и доставке.
- validateContacts - Выполняет проверку корректности контактных данных

а также геттеры и сеттеры

### Классы представления 

Классы представления преобразуют данные в визуальное представление (HTML) и отображают его в заданном DOM-элементе на странице.

#### Базовый Класс Component

Это базовый, параметризованный (дженерик) класс для всех компонентов UI. Он требует указания типа данных, с которыми будет работать компонент. В конструктор передается DOM-элемент, в котором компонент будет отображаться. Метод render получает данные, устанавливает их в соответствующие поля компонента (через сеттеры) и возвращает обновленный DOM-контейнер.

#### Класс Modal

Предоставляет базовую функциональность для создания и управления модальными окнами

- constructor - конструктор принимает DOM-элемент контейнера и экземпляр EventEmitter для связи с другими компонентами через события.

Поля класса:
- _closeButton - кнопка закрытия модального окна
- _content - содержимое модального окна

Методы:
- open() - метод для открытие модального окна
- close() - мутод для закрытие модального окна
- render - метод отображает модальное окно, заполняя его содержимым на основе переданных данных.

#### Класс Card

 Класс отвечает за создание и отображение карточки товара, заполняя её данными (название, изображение, описание, категория). Он получает шаблон карточки в конструкторе, что позволяет использовать разные варианты верстки. Также устанавливает обработчики событий на интерактивные элементы карточки.\
Поля класса содержат элементы разметки элементов карточки. Конструктор, кроме темплейта принимает экземпляр `EventEmitter` для инициации событий.

Методы:
- updateAddButtonState - управление статусом кнопки
- deleteCard - удаление карточки
а также геттеры и сеттеры

#### Класс CardsContainer

Класс отвечает за отображение списка карточек товаров в заданном DOM-элементе.

Поля класса:
- _catalog - массив карточек

Метод:
- set catalog - отвечает за обновление отображения карточек товаров на странице

#### Класс Basket

Класс отвечает за визуальное представление корзины. Отображает кнопку, цену и нумерацию списка.

Поля класса:
- list - список товаров
- total - общая цена товаров
- button - кнопка корзины

Метод:
- set total - для подсчета общей стоимости товаров

#### Класс Form

Этот класс управляет поведением и данными формы, обрабатывает события, происходящие в форме, и обеспечивает взаимодействие с другими компонентами приложения. Конструктор принимает DOM-элемент, содержащий форму.

Поля:
- button - управление кнопкой
- errors - управление ошибками

Методы:
- onInputChange - отправляет уведомление в виде события при каждом изменении значения поля формы.
- buttonActive - управление кнопкой

### Слой коммуникации

#### Класс AppApi

Класс, который управляет запросами к API бэкенда. В конструктор принимает экземпляр класса Api, который предоставляет методы для выполнения этих запросов.

## Взаимодействие компонентов
В index.ts реализуется логика, соединяющая классы представления с данными, используя паттерн презентера. Для обмена информацией между компонентами используются события, генерируемые брокером событий. В index.ts происходит создание экземпляров всех классов представления и настройка обработчиков событий, обеспечивающих взаимодействие между ними.

